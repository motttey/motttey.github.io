(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{364:function(t,e,n){var content=n(381);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(13).default)("c999fe10",content,!0,{sourceMap:!1})},380:function(t,e,n){"use strict";n(364)},381:function(t,e,n){var r=n(12)((function(i){return i[1]}));r.push([t.i,"@media (min-width:480px){#canvas_holder{width:100%}}@media (max-width:480px){#canvas_holder{width:90%;margin:5%}}#target_image{top:0;background-color:none}",""]),r.locals={},t.exports=r},389:function(t,e,n){"use strict";n.r(e);var r=n(24),o=(n(82),n(48),n(25),n(6),n(34),n(54),n(44),n(21),n(67),n(68),n(379)),c=n(399),l=n(445),h={data:function(){return{tagName:"",tags:[],target_illust:{title:"dora1",date:"20200718",tags_text:"#doraemon",src:"/doraemon-namecard.webp",url:"https://www.pixiv.net/users/415546",flex:12},canvas_settings:{canvas_width:1200,canvas_height:650,canvas_offset_x:0,canvas_offset_y:-50,box_size:40,image_max:200},api_url:"https://mochiduko-api.netlify.app/",pixiv_embed:"http://embed.pixiv.net/decorate.php",pixiv_artwork:"https://www.pixiv.net/artworks/",axes:["tsne-X","tsne-Y","tsne-Z"],mousePosition:[],target_images:[],renderer:new Object,canvas:new Object,scene:new o.j,camera:new Object,controls:new Object,MOUNTED:!1,INTERSECTED:!1}},watch:{mousePosition:function(t){t&&this.selectImage(t)}},mounted:function(){this.renderer=new o.p({alpha:!0}),this.canvas=this.$refs.canvas_holder,this.canvas_settings.canvas_width=this.canvas.clientWidth,this.canvas.appendChild(this.renderer.domElement),this.renderer.setSize(this.canvas_settings.canvas_width,this.canvas_settings.canvas_height),this.camera=new o.e(45,this.canvas_settings.canvas_width/this.canvas_settings.canvas_height,.5,1e3),this.controls=new c.a(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.autoRotate=!0,this.controls.autoRotateSpeed=1,this.controls.dampingFactor=.25,this.controls.enableZoom=!0,this.renderer.setSize(this.canvas_settings.canvas_width,this.canvas_settings.canvas_height),this.renderer.setClearColor(0,0),this.renderer.clear(),this.drawScatter(),this.renderScene(),this.MOUNTED=!0},methods:{v:function(t,e,n){return new o.o(t,e,n)},renderScene:function(){requestAnimationFrame(this.renderScene),this.controls.update(),this.renderer.render(this.scene,this.camera)},setTargetImageProperties:function(t){this.target_illust.src=this.pixiv_embed+"?illust_id="+t.id+"&mode=sns-automator",this.target_illust.title=t.title,this.target_illust.date=t.date,this.target_illust.tags_text=t.tags.map((function(t){return"#"+t.name})).join(" "),this.target_illust.url=this.pixiv_artwork+t.id},calcMousePositionInCanvas:function(t){var e=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft-Math.floor(this.canvas.offsetLeft),n=t.clientY+document.body.scrollTop+document.documentElement.scrollTop-Math.floor(this.canvas.offsetTop);return[e=(e+this.canvas_settings.canvas_offset_x)/this.canvas_settings.canvas_width*2-1,n=-(n+this.canvas_settings.canvas_offset_y)/this.canvas_settings.canvas_height*2+1]},onDocumentMouseMove:function(t){this.mousePosition=this.calcMousePositionInCanvas(t)},onTouch:function(t){t.touches&&t.touches.length>0?this.mousePosition=this.calcMousePositionInCanvas(t.touches[0]):t.changedTouches&&t.changedTouches.length>0&&(this.mousePosition=this.calcMousePositionInCanvas(t.changedTouches[0]))},selectImage:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,c,l,h,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=new o.i,c=new o.n(t[0],t[1]),r.setFromCamera(c,e.camera),l=e.scene.children[0].children,!((h=r.intersectObjects(l.slice(0,l.length-1),!0).filter((function(t){return t.object.name&&t.object.visible}))).length>0)){n.next=11;break}if(0!==(d=e.target_images.filter((function(img){return img.id==h[0].object.name}))).length){n.next=9;break}return n.abrupt("return");case 9:return n.next=11,e.setTargetImageProperties(d[0]);case 11:case"end":return n.stop()}}),n)})))()},onResize:function(){if(this.MOUNTED){var t=this.canvas.clientWidth,e=this.canvas_settings.canvas_height;this.renderer.setSize(this.canvas.clientWidth,this.canvas_settings.canvas_height),this.camera.aspect=t/e,this.camera.updateProjectionMatrix()}},filterImage:function(){var t=this,e=this.scene.children[0].children;if(0!==this.tags.length){var n=this.target_images.filter((function(image){return image.tags.some((function(e){return t.tags.includes(e.name)}))})).map((function(image){return image.id.toString()}));e.forEach((function(t){t.visible=!!n.includes(t.name)}))}else e.forEach((function(t){return t.visible=!0}))},addNewTag:function(){this.tags.includes(this.tagName)||(this.tags.push(this.tagName),this.tagName="",this.filterImage())},removeTag:function(t){this.tags.splice(t,1),this.filterImage()},drawScatter:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,c,h,d,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new o.d,r=t.canvas_settings.box_size,c=t.v,t.scene.add(n),h={},d=t.axes,v=t.api_url,e.next=9,t.$axios.$get(v+"each_illusts.json").then((function(data){t.target_images=data.slice(0,t.canvas_settings.image_max),d.forEach((function(e,i){h[e]=[Math.max.apply(Math,t.target_images.map((function(t){return t[e]}))),Math.min.apply(Math,t.target_images.map((function(t){return t[e]})))]})),t.target_images.forEach((function(t){var e=new o.m;e.setCrossOrigin("anonymous"),e.load(v+"thumbs/"+t.id+".webp",(function(e){var v=new o.g({color:16777215,size:20,transparent:!0,map:e}),m=d.map((function(t){return Object(l.a)().domain(h[t]).range([-r,r])})),_=[],f=m[0](t["tsne-X"]),w=m[1](t["tsne-Y"]),x=m[2](t["tsne-Z"]);_.push(c(f,w,x));var T=(new o.a).setFromPoints(_),C=new o.f(T,v);T.name=t.id.toString(),C.name=t.id.toString(),n.add(C)}))}))})).catch((function(t){console.log("response error",t)}));case 9:t.setTargetImageProperties(t.target_images[0]),t.renderer.setSize(t.canvas_settings.canvas_width,t.canvas_settings.canvas_height),t.renderer.setViewport(-1*t.canvas_settings.canvas_offset_x,0,t.canvas_settings.canvas_width,t.canvas_settings.canvas_height),t.controls.update(),t.renderer.render(t.scene,t.camera),t.camera.position.set(100,100,100);case 15:case"end":return e.stop()}}),e)})))()}}},d=(n(380),n(73)),v=n(97),m=n.n(v),_=n(331),f=n(350),w=n(347),x=n(398),T=n(361),C=n(341),M=n(124),k=n(362),j=n(344),E=n(439),I=n(400),N=n.n(I),S=n(159),component=Object(d.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:"",id:"Gallery"}},[n("h1",[t._v("Gallery")]),t._v(" "),n("h3",[t._v("これまでに描いたイラストなどです. ")]),t._v(" "),n("v-row",{staticClass:"mb-6",attrs:{align:"center"}},[n("v-col",{attrs:{sm:"8",cols:"12"}},[n("div",{staticClass:"d-flex flex-row align-baseline"},[n("v-text-field",{staticClass:"mb-6 mr-6",attrs:{"hide-details":"","single-line":"",label:"Input Tag Name"},on:{submit:function(t){t.preventDefault()}},model:{value:t.tagName,callback:function(e){t.tagName=e},expression:"tagName"}}),t._v(" "),n("v-btn",{attrs:{color:"white",elevation:"1",outlined:""},on:{click:function(e){return t.addNewTag()}}},[t._v("\n          Filter\n        ")])],1),t._v(" "),t._l(t.tags,(function(e,r){return n("v-chip",{key:e,attrs:{filter:"",outlined:"",close:""},on:{"click:close":function(e){return t.removeTag(r)}}},[t._v("\n        "+t._s(e)+"\n      ")])}))],2)],1),t._v(" "),n("v-row",{staticClass:"mb-6",attrs:{align:"center"}},[n("v-col",{directives:[{name:"resize",rawName:"v-resize",value:t.onResize,expression:"onResize"}],attrs:{sm:"8",cols:"12"}},[n("div",{ref:"canvas_holder",attrs:{id:"canvas_holder"},on:{mousemove:function(e){return t.onDocumentMouseMove(e)},click:function(e){return t.onTouch(e)},touchend:function(e){return t.onTouch(e)}}})]),t._v(" "),n("v-col",{staticClass:"mx-auto",attrs:{sm:"4",cols:"8"}},[n("v-card",{attrs:{id:"target_image"}},[n("a",{attrs:{href:t.target_illust.url,target:"_blank"}},[n("v-img",{staticClass:"white--text align-end",attrs:{src:t.target_illust.src,"aspect-ratio":"1"}})],1),t._v(" "),n("v-card-actions",[n("v-spacer")],1),t._v(" "),n("v-card-text",[n("h2",[t._v(t._s(t.target_illust.title))]),t._v(" "),n("p",[t._v(t._s(t.target_illust.date))]),t._v(" "),n("p",[t._v(t._s(t.target_illust.tags_text))])])],1)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;m()(component,{VBtn:_.a,VCard:f.a,VCardActions:w.a,VCardText:w.b,VChip:x.a,VCol:T.a,VContainer:C.a,VImg:M.a,VRow:k.a,VSpacer:j.a,VTextField:E.a}),N()(component,{Resize:S.a})}}]);